{% extends "user/base.html" %}

{% block title %}Профиль | Mastodontco{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-sm mb-6">
    <h1 class="text-xl font-semibold text-gray-900">Мой профиль</h1>
    <p class="text-sm text-gray-600 mt-1">Управление профилем и персональными настройками</p>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
    <!-- Основная информация -->
    <div class="lg:col-span-2 space-y-6">
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Персональная информация</h2>
                <p class="mt-1 text-sm text-gray-500">Обновление вашей личной информации и контактных данных</p>
            </div>
            
            <form action="#" method="post" class="mt-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label for="first_name" class="block text-sm font-medium text-gray-700">Имя</label>
                        <input type="text" name="first_name" id="first_name" autocomplete="given-name" value="{{ user.first_name }}" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div>
                        <label for="last_name" class="block text-sm font-medium text-gray-700">Фамилия</label>
                        <input type="text" name="last_name" id="last_name" autocomplete="family-name" value="{{ user.last_name }}" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" name="email" id="email" autocomplete="email" value="{{ user.email }}" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700">Телефон</label>
                        <input type="tel" name="phone" id="phone" autocomplete="tel" value="{{ user.phone }}" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div class="col-span-1 md:col-span-2">
                        <label for="about" class="block text-sm font-medium text-gray-700">О себе</label>
                        <textarea id="about" name="about" rows="3" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">{{ user.about }}</textarea>
                        <p class="mt-2 text-sm text-gray-500">Краткая информация о вас для вашего публичного профиля.</p>
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Сохранить изменения
                    </button>
                </div>
            </form>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Изменить пароль</h2>
                <p class="mt-1 text-sm text-gray-500">Обеспечьте безопасность вашего аккаунта с помощью надежного пароля</p>
            </div>
            
            <form action="#" method="post" class="mt-6">
                <div class="space-y-4">
                    <div>
                        <label for="current_password" class="block text-sm font-medium text-gray-700">Текущий пароль</label>
                        <input type="password" name="current_password" id="current_password" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div>
                        <label for="new_password" class="block text-sm font-medium text-gray-700">Новый пароль</label>
                        <input type="password" name="new_password" id="new_password" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>

                    <div>
                        <label for="password_confirmation" class="block text-sm font-medium text-gray-700">Подтверждение пароля</label>
                        <input type="password" name="password_confirmation" id="password_confirmation" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm">
                    </div>
                </div>
                
                <div class="mt-6 flex justify-end">
                    <button type="submit" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Обновить пароль
                    </button>
                </div>
            </form>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Двухфакторная аутентификация</h2>
                <p class="mt-1 text-sm text-gray-500">Добавьте дополнительный уровень безопасности для вашего аккаунта</p>
            </div>
            
            <div class="mt-6">
                <div class="flex items-start">
                    <div class="flex items-center h-5">
                        <input id="2fa" name="2fa" type="checkbox" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" {% if user.has_2fa %}checked{% endif %}>
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="2fa" class="font-medium text-gray-700">Включить двухфакторную аутентификацию</label>
                        <p class="text-gray-500">При входе в систему потребуется дополнительный код подтверждения с вашего устройства.</p>
                    </div>
                </div>
                
                {% if user.has_2fa %}
                <div class="mt-4 p-4 bg-gray-50 rounded-md">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                            </svg>
                        </div>
                        <div class="ml-3">
                            <h3 class="text-sm font-medium text-green-800">Двухфакторная аутентификация активирована</h3>
                            <div class="mt-2 text-sm text-green-700">
                                <p>Ваш аккаунт защищен двухфакторной аутентификацией.</p>
                            </div>
                            <div class="mt-4">
                                <div class="-mx-2 -my-1.5 flex">
                                    <button type="button" class="px-2 py-1.5 rounded-md text-sm font-medium text-green-800 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                                        Настроить заново
                                    </button>
                                    <button type="button" class="ml-3 px-2 py-1.5 rounded-md text-sm font-medium text-green-800 hover:bg-green-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                                        Отключить
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="mt-4">
                    <button type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                        Настроить двухфакторную аутентификацию
                    </button>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- Боковая информация -->
    <div class="space-y-6">
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Фото профиля</h2>
                <p class="mt-1 text-sm text-gray-500">Изменить фото профиля</p>
            </div>
            
            <div class="mt-6 flex flex-col items-center">
                <div class="relative">
                    {% if user.avatar %}
                    <img src="{{ user.avatar }}" alt="{{ user.name }}" class="h-32 w-32 rounded-full">
                    {% else %}
                    <div class="h-32 w-32 rounded-full bg-blue-500 flex items-center justify-center text-white text-3xl font-medium">
                        {{ user.initials }}
                    </div>
                    {% endif %}
                    
                    <button type="button" class="absolute bottom-0 right-0 h-8 w-8 rounded-full bg-white shadow-md flex items-center justify-center hover:bg-gray-50">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 13a3 3 0 11-6 0 3 3 0 016 0z" />
                        </svg>
                    </button>
                </div>
                
                <div class="mt-6 text-center">
                    <input type="file" id="avatar" name="avatar" class="hidden">
                    <label for="avatar" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 text-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0l-4 4m4-4v12" />
                        </svg>
                        Загрузить новое фото
                    </label>
                    {% if user.avatar %}
                    <button type="button" class="mt-2 text-sm text-red-600 hover:text-red-900">Удалить фото</button>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200">
                <h2 class="text-lg font-semibold text-gray-900">Настройки уведомлений</h2>
                <p class="mt-1 text-sm text-gray-500">Управление уведомлениями о событиях системы</p>
            </div>
            
            <div class="mt-6 space-y-4">
                <div class="flex items-start">
                    <div class="flex items-center h-5">
                        <input id="email_notifications" name="email_notifications" type="checkbox" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" {% if user_settings and user_settings.email_notifications %}checked{% endif %}>
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="email_notifications" class="font-medium text-gray-700">Email-уведомления</label>
                        <p class="text-gray-500">Получать уведомления о важных событиях на email.</p>
                    </div>
                </div>
                
                <div class="flex items-start">
                    <div class="flex items-center h-5">
                        <input id="push_notifications" name="push_notifications" type="checkbox" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" {% if user_settings and user_settings.push_notifications %}checked{% endif %}>
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="push_notifications" class="font-medium text-gray-700">Push-уведомления</label>
                        <p class="text-gray-500">Получать уведомления в браузере.</p>
                    </div>
                </div>
                
                <div class="flex items-start">
                    <div class="flex items-center h-5">
                        <input id="sms_notifications" name="sms_notifications" type="checkbox" class="focus:ring-blue-500 h-4 w-4 text-blue-600 border-gray-300 rounded" {% if user_settings and user_settings.sms_notifications %}checked{% endif %}>
                    </div>
                    <div class="ml-3 text-sm">
                        <label for="sms_notifications" class="font-medium text-gray-700">SMS-уведомления</label>
                        <p class="text-gray-500">Получать важные уведомления по SMS.</p>
                    </div>
                </div>
            </div>
            
            <div class="mt-6 flex justify-end">
                <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                    Сохранить настройки
                </button>
            </div>
        </div>
        
        <div class="bg-white p-6 rounded-lg shadow-sm">
            <div class="pb-6 border-b border-gray-200 flex items-center justify-between">
                <div>
                    <h2 class="text-lg font-semibold text-gray-900">Удаление аккаунта</h2>
                    <p class="mt-1 text-sm text-gray-500">Удалить аккаунт и все связанные с ним данные</p>
                </div>
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
            </div>
            
            <div class="mt-6">
                <p class="text-sm text-gray-500">
                    После удаления вашего аккаунта, все личные данные будут безвозвратно удалены из нашей системы. Это действие нельзя отменить.
                </p>
                <div class="mt-4">
                    <button type="button" class="inline-flex items-center px-4 py-2 border border-red-300 shadow-sm text-sm font-medium rounded-md text-red-700 bg-white hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                        Удалить аккаунт
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Последние действия -->
<section>
    <h3 class="text-lg font-medium mb-4 text-gray-700">Последние действия</h3>
    <div class="space-y-4">
        {% for activity in activity_log %}
        <div class="bg-white p-4 rounded-lg shadow-sm">
            <div class="flex items-start">
                <div class="rounded-full bg-blue-100 p-2 mr-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                    </svg>
                </div>
                <div>
                    <div class="text-sm font-medium text-gray-800">{{ activity.action }}</div>
                    <div class="text-xs text-gray-500">{{ activity.target }}</div>
                    <div class="text-xs text-gray-400 mt-1">{{ activity.date }}</div>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %} 